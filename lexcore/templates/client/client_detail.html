{% extends 'layout/base.html' %}
{% load static %}
{% block title %}
Client Details
{% endblock title %}
{% block content %}
<div class="d-flex">
    {% include 'layout/sidebar.html' %}
    <div class="w-100">
        {% include 'layout/header.html' %}
        <div class="my-3 mx-3">
            <div class="card-header text-center text-white bg-primary">
                <b>{{client.client_name}}</b>
            </div>

            <!-- Nav pills -->
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#detail">Client Detail</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#contacts">Contact Persons</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#folders">Folders</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#matters">Matters</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#activity">Activities</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#duedates">Due Dates</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#billings">Accounts Receivables</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#emails">Emails</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#chat">Chatter</a>
                </li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane container active" id="detail">
                    <a class="btn btn-secondary btn-sm mt-1" data-bs-toggle="modal" data-bs-target="#addclientModal"
                        title="New Client"><i class="fas fa-plus"></i></a>

                    <a class="btn btn-secondary btn-sm mt-1" href="{% url 'edit-client' client.id %}"
                        title="Modify Client"><i class="fas fa-edit"></i></a>

                    <a class="btn btn-secondary btn-sm mt-1" href="{% url 'remove-client' client.id %}"
                        title="Delete Client"><i class="fas fa-trash-alt"></i></a>
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Client Number</span>
                                <input type="text" name="folder" value="{{client.client_number}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Client Name</span>
                                <input type="text" name="folder" value="{{client.client_name}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Address</span>
                                <input type="text" name="folder" value="{{client.address}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> City </span>
                                <input type="text" name="folder" value="{{client.city}}" class="form-control" readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> State </span>
                                <input type="text" name="folder" value="{{client.state}}" class="form-control" readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Country Code </span>
                                <input type="text" name="folder" value="{{client.country}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Zip Code </span>
                                <input type="text" name="folder" value="{{client.zip_code}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Web Site </span>
                                <input type="text" name="folder" value="{{client.website}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Account Officer </span>
                                <input type="text" name="folder" value="{{client.account_officer}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Position </span>
                                <input type="text" name="folder" value="{{client.position}}" class="form-control"
                                    readonly>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Date Acquired </span>
                                <input type="text" name="folder" value="{{ client.date_acquired}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Entity Type </span>
                                <input type="text" name="folder" value="{{ client.entity_type }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Category </span>
                                <input type="text" name="folder" value="{{ client.category }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Industry </span>
                                <input type="text" name="folder" value="{{ client.industry }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Client Type </span>
                                <input type="text" name="folder" value="{{ client.client_type }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Email </span>
                                <input type="text" name="folder" value="{{ client.email }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Landline </span>
                                <input type="text" name="folder" value="{{ client.landline }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Mobile </span>
                                <input type="text" name="folder" value="{{ client.mobile }}" class="form-control"
                                    readonly>
                            </div>

                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Status </span>
                                <input type="text" name="folder" value="{{ client.status}}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Referred By </span>
                                <input type="text" name="folder" value="{{ client.referredby}}" class="form-control"
                                    readonly>
                            </div>

                        </div>
                        <div class="col-lg-12">
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text" style="width: 113px;"> Remarks </span>
                                <input type="text" name="folder" value="{{ client.remarks}}" class="form-control"
                                    readonly>
                            </div>
                        </div>
                        <div class="h6 pb-2 mb-2 text-success border-bottom border-success">
                            <b>Billing Information</b>
                        </div>

                        <div class="col-lg-6">
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Bill Attention </span>
                                <input type="text" name="folder" value="{{ client.billing_attention }}"
                                    class="form-control" readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Bill To </span>
                                <input type="text" name="folder" value="{{ client.billing_to }}" class="form-control"
                                    readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Bill Address </span>
                                <input type="text" name="folder" value="{{ client.billing_address }}"
                                    class="form-control" readonly>
                            </div>
                            <div class="input-group input-group-sm mb-1 mt-1">
                                <span class="input-group-text" style="width: 113px;"> Currency </span>
                                <input type="text" name="folder" value="{{ client.billing_currency }}"
                                    class="form-control" readonly>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="tab-pane container fade mb-1" id="matters">
                    <table class="table-hover table-bordered table-sm small table mt-1" id="clientmatterlist">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:27%;">Folder</th>
                                <th scope="col" style="width:10%;">Lawyer</th>
                                <th scope="col" style="width:10%;">Reference#</th>
                                <th scope="col" style="width:10%;">Date Filed</th>
                                <th scope="col" style="width:35%;">Matter Title</th>
                                <th scope="col" style="width:5%;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for matter in matters %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ matter.folder }}</td>
                                <td>{{ matter.handling_lawyer.access_code }}</td>
                                <td>{{ matter.matterno }}</td>
                                <td>{{ matter.filing_date | date:'m/d/Y' }}</td>
                                <td>{{ matter.matter_title }}</td>
                                <!-- <td><a class="btn btn-secondary btn-sm"
                                        href="#" title="Modify"><i
                                            class="fas fa-edit"></i></a>
                                </td> -->
                                <td class="text-center"><a class="btn btn-secondary btn-sm"
                                        href="{% url 'select-matter' matter.id %}" title="Select"><i
                                            class="far fa-hand-pointer"></i></a>
                                </td>

                                <!-- <td><a class="btn btn-secondary btn-sm"
                                        href="{% url 'removeclient-matter' matter.id client.id %}" title="Delete"><i
                                            class="fas fa-trash-alt"></i></a>
                                </td> -->
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade" id="folders">
                    {% comment %} {% for msg in messages %}
                    <div class="alert alert-danger text-center" role="alert">
                        {{ msg }}
                    </div>
                    {% endfor%} {% endcomment %}

                    <a class="btn btn-secondary btn-sm mt-1" data-bs-toggle="modal" data-bs-target="#addfolderModal"
                        title="New Client Folder"><i class="fas fa-plus"></i></a>
                    <table class="table-hover table-bordered table-sm small table mt-1">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:15%;">Folder/Areas</th>
                                <th scope="col" style="width:30%;">Folder Description</th>
                                <th scope="col" style="width:15%;">Supervising Lawyer</th>
                                <th scope="col" style="width:15%;">Remarks</th>
                                <th colspan="2" style="width:5%;">Action</th>

                            </tr>
                        </thead>
                        <tbody>
                            {% for folder in folders %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ folder.folder_type }}</td>
                                <td>{{ folder.folder_description }}</td>
                                <td>{{ folder.Supervisinglawyer }}</td>
                                <td>{{ folder.remarks }}</td>
                                <!-- <td style="text-align: center;"><a class="btn btn-secondary btn-sm"
                                        href="{% url 'newfolder-matter' folder.id client.id %}"
                                        title="New folder matter"><i class="fas fa-plus"></i></a>
                                </td> -->
                                <td style="text-align: center;"><a class="btn btn-secondary btn-sm"
                                        href="{% url 'folder-detail' folder.id %}" title="View folder matters"><i
                                            class="far fa-hand-pointer"></i></a>
                                </td>
                                <td><a class="btn btn-secondary btn-sm"
                                        href="{% url 'delete-folder' folder.id client.id %}" title="Remove Folder"><i
                                            class="fas fa-trash-alt"></i></a>
                                </td>


                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>

                    <table class="table-hover table-bordered table-sm small table mt-1">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:77%;">Folder/Practice Areas</th>
                                <th scope="col" style="width:15%;">No. Of Matters</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for folder in folder_result %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ folder.folder__folder_type__folder }}</td>
                                <td style="text-align: center;"><a
                                        href="{% url 'folder-matters' folder.folder__folder_type__id client.id %}">
                                        {{folder.NoOfMatters }}</a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade" id="contacts">
                    <a class="btn btn-secondary btn-sm mt-1" data-bs-toggle="modal" data-bs-target="#addcontactModal"
                        title="New Contact"><i class="fas fa-plus"></i></a>


                    <table class="table-hover table-bordered table-sm small table mt-1">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:22%;">Contact Persons</th>
                                <th scope="col" style="width:15%;">Position</th>
                                <th scope="col" style="width:40%;">Address</th>
                                <th scope="col" style="width:15%;">Phone</th>
                                <th colspan="2" style="width:5%;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for contact in contacts %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td><a
                                        href="{% url 'viewclientdetails-contact' contact.id client.id contact.contact_person %}">
                                        {{contact.contact_person }}</a></td>
                                <td>{{ contact.position }}</td>
                                <td>{{ contact.address }}</td>
                                <td>{{ contact.phone }}</td>

                                <td><a class="btn btn-secondary btn-sm"
                                        href="{% url 'edit-contact' contact.id client.id %}" title="Modify"><i
                                            class="fas fa-edit"></i></a>
                                </td>
                                <td><a class="btn btn-secondary btn-sm"
                                        href="{% url 'remove-contact' contact.id client.id %}" title="New Matter"><i
                                            class="fas fa-trash-alt"></i></a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade mb-1" id="activity">
                    <table class="table-hover table-bordered table-sm small table mt-1" id="clientactivitylist">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:32%;">Matter</th>
                                <th scope="col" style="width:10%;">Activity Date</th>
                                <th scope="col" style="width:5%;">Type</th>
                                <th scope="col" style="width:5%;">Lawyer</th>
                                <th scope="col" style="width:40%;">Activity</th>
                                <th scope="col" style="width:5%;">Select</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for activity in activities %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ activity.matter.matter_title }}</td>
                                <td>{{ activity.tran_date }}</td>
                                <td>{{ activity.tran_type }}</td>
                                <td>{{ activity.lawyer.access_code }}</td>
                                <td>{{ activity.task }}</td>

                                <td class="text-center"><a class="btn btn-secondary btn-sm" href="#" title="Modify"><i
                                            class="far fa-hand-pointer"></i></a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade" id="duedates">
                    <table class="table-hover table-bordered table-sm small table" id="clientduedatelist">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:10%;">Due Date</th>
                                <th scope="col" style="width:25%;">Matter Title</th>
                                <th scope="col" style="width:10%;">File Number</th>
                                <th scope="col" style="width:10%;">Date Filed</th>
                                <th scope="col" style="width:5%;">Lawyer</th>
                                <th scope="col" style="width:25%;">Particulars</th>
                                <th scope="col" style="width:10%;">Date Complied</th>
                                <th scope="col" style="width:2%;">Select</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for duedate in duedates %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ duedate.duedate | date:'m/d/Y' }}</td>
                                <td>{{ duedate.matter.matter_title}}</td>
                                <td>{{ duedate.matter.matterno}}</td>
                                <td>{{ duedate.matter.filing_date | date:'m/d/Y' }}</td>
                                <td>{{ duedate.matter.handling_lawyer.access_code }}</td>
                                <td>{{ duedate.particulars }}</td>
                                <td>{{ duedate.date_complied | date:'m/d/Y' }}</td>
                                <td class="text-center"><a class="btn btn-secondary btn-sm"
                                        href="{% url 'select-matter' duedate.matter.id %}" title="Edit Due Date"><i
                                            class="far fa-hand-pointer"></i></a>
                                </td>
                            </tr>
                            {% endfor %}msginbox
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade" id="billings">
                    <table class="table-hover table-bordered table-sm small table" id="clientbillings">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:12%;">Bill Date</th>
                                <th scope="col" style="width:13%;">Bill #</th>
                                <th scope="col" style="width:12%;">PF</th>
                                <th scope="col" style="width:12%;">Filing</th>
                                <th scope="col" style="width:12%;">OPE</th>
                                <th scope="col" style="width:10%;">Rate</th>
                                <th scope="col" style="width:12%;">Bill Amount USD</th>
                                <th scope="col" style="width:12%;">Bill Amount PHP</th>
                                <th scope="col" style="width:2%;">Select</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for AR in accounts_receivables %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ AR.bill_date | date:'m/d/Y' }}</td>
                                <td>{{ AR.bill_no}}</td>
                                <td>{{ AR.pf_amount }}</td>
                                <td>{{ AR.filing_amount }}</td>
                                <td>{{ AR.ope_amount }}</td>
                                <td>{{ AR.peso_rate_used }}</td>
                                <td>{{ AR.total_USDamount }}</td>
                                <td>{{ AR.total_PhPamount }}</td>
                                <td class="text-center"><a class="btn btn-secondary btn-sm" href="#"
                                        title="Edit Due Date">
                                        <i class="far fa-hand-pointer"></i></a>
                                </td>

                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade" id="emails">
                    <!-- Button trigger modal -->
                    <table class="table-hover table-bordered table-sm small table" id="emaillist">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:25%;">Matter</th>
                                <th scope="col" style="width:10%;">Email Date</th>
                                <th scope="col" style="width:10%;">Emailed By</th>
                                <th scope="col" style="width:50%;">Message</th>
                                <th scope="col" style="width:5%;">Select</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for email in emails %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ email.matter }}</td>
                                <td>{{ email.created_at | date:'m/d/Y' }}</td>
                                <td>{{ email.sentby }}</td>
                                <td>{{ email.message }}</td>
                                <td style="text-align: center;"><a class="btn btn-secondary btn-sm"
                                        href="{% url 'view_email' email.id %}" title="Select Email"><i
                                            class="far fa-hand-pointer"></i></a>
                                </td>

                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane container fade" id="chat">
                    <!-- Button trigger modal -->
                    <table class="table-hover table-bordered table-sm small table" id="maillist">
                        <thead class="table-primary text-center">
                            <tr>
                                <th scope="col" style="width:3%;">#</th>
                                <th scope="col" style="width:10%;">Chat from</th>
                                <th scope="col" style="width:10%;">Chat to </th>
                                <th scope="col" style="width:15%;">Date</th>
                                <th scope="col" style="width:50%;">Message</th>
                                <th scope="col" style="width:5%;">Select</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for inboxmsg in msginbox %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td><a href="{% url 'view-chat' inboxmsg.id %}">{{ inboxmsg.messagefrom }}</a></td>
                                <td>{{ inboxmsg.messageto }}</td>
                                <td>{{ inboxmsg.created_at }}</td>
                                <td>{{ inboxmsg.messagebox }}</td>
                                <td style="text-align: center;"><a class="btn btn-secondary btn-sm"
                                        href="{% url 'open-chat' inboxmsg.id %}" title="Select Email"><i
                                            class="far fa-hand-pointer"></i></a>
                                </td>

                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{% for message in messages %}
{% if message.tags == 'sucess' %}
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    var m = "{{ message }}"
    swal("perfect !", m, "success")
</script>
{% endif %}
{% endfor %}

{% endblock %}